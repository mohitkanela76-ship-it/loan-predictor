<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Loan Prediction Form</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
/* Base Styles - Increased Font Sizes */
body { font-family: 'Inter', sans-serif; margin:0; padding:0; background:#f0f9ff; /* Very Light Blue Background */ }
nav { background:white; padding:1.25rem 2rem; display:flex; align-items:center; box-shadow:0 2px 5px rgba(0,0,0,0.1);}
nav a { margin-right:2rem; text-decoration:none; color:#1f2937; font-weight:700; font-size: 1.25rem; transition:color 0.2s; cursor: pointer;}
nav a:hover { color:#5b21b6;}

/* --- HEADER IMPROVEMENTS --- */
.page-header {
    background: #5b21b6; /* Deep Purple */
    color: white;
    padding: 3rem 2rem;
    text-align: center;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    margin-bottom: 2rem;
}
.page-header h2 {
    font-size: 2.5rem; /* Increased size */
    margin-bottom: 0.5rem;
}
.page-header p {
    font-size: 1.2rem; /* Increased paragraph size */
    opacity: 0.9;
}

/* --- FULL PAGE OCCUPANCY / SIDE DESIGN --- */
.full-page-container {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding: 0 2rem 4rem 2rem;
}

/* Side decoration elements - Aesthetic tweaks (UPDATED with Design/Texture) */
.side-design {
    width: 20%;
    max-width: 250px;
    padding: 2rem;
    margin-top: 2rem; 
    color: #1e3a8a;
    font-weight: 600;
    font-size: 1.1rem; 
    background-color: #dbeafe; /* Light blue panel */
    border-radius: 12px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.05);
    /* --- NEW DESIGN/TEXTURE: Diagonal Stripes --- */
    background-image: repeating-linear-gradient(
        45deg, 
        #dbeafe, /* Lighter blue */
        #dbeafe 10px, 
        #bfdbfe 10px, /* Slightly darker blue */
        #bfdbfe 20px
    );
    border: 1px solid #93c5fd; /* Added a border for definition */
}
.side-design ul {
    list-style: disc;
    padding-left: 1.25rem;
    margin: 0.5rem 0;
    font-size: 1rem;
}
.side-design h3 {
    border-bottom: 2px solid #5b21b6;
    padding-bottom: 0.5rem;
    margin-bottom: 1rem;
    font-size: 1.4rem; 
}

/* Form container remains central */
.form-container { 
    width: 100%;
    max-width: 650px;
    margin: 0 2rem;
    background-color:#fff; 
    padding:3rem; 
    border-radius:12px;
    box-shadow: 0 15px 30px rgba(0,0,0,0.15); 
    border-top: 5px solid #5b21b6; 
}

/* Aesthetic Change: Label Font Size */
.form-container label { 
    display:block; 
    margin:1.25rem 0 0.75rem; 
    font-weight:700; 
    color:#4c1d95; /* Darker purple text for labels */
    font-size: 1.2rem; 
}

/* Enhanced input/select fields - Aesthetic changes (UPDATED BACKGROUND COLOR) */
.form-container input, .form-container select { 
    width:100%; 
    padding:1rem; 
    border-radius:8px; 
    border:1px solid #c8d3e6; 
    font-size: 1.15rem; 
    /* NEW: Light blue background fill */
    background-color: #e0f7ff; 
    transition: border-color 0.3s, box-shadow 0.3s;
}
.form-container input:focus, .form-container select:focus {
    /* Purple border on focus */
    border-color: #5b21b6; 
    /* Purple shadow ring */
    box-shadow: 0 0 0 3px rgba(91, 33, 182, 0.3); 
    outline: none;
    background-color: white; /* Keep white on focus for contrast */
}
::placeholder {
    color: #9ca3af;
    opacity: 1; 
}

/* --- BUTTON STYLES (3D PRESS EFFECT) --- */
.button-row {
    display: flex;
    justify-content: space-between;
    gap: 20px;
    margin-top: 2.5rem;
}

.button-row button {
    width: 50%;
    padding: 1rem;
    font-size: 1.25rem; 
    border: none;
    cursor: pointer;
    border-radius: 8px;
    transition: background-color 0.2s, transform 0.1s, box-shadow 0.2s; 
}

/* Primary Button (Submit - Left) */
.form-container #predictBtn { 
    background-color:#5b21b6; 
    color:white;
    box-shadow: 0 4px 0 0 #4c1d95; /* Inner color/shadow */
}
.form-container #predictBtn:hover { 
    background-color: #4c1d95; 
    box-shadow: 0 2px 0 0 #3c1575; 
}
.form-container #predictBtn:active {
    box-shadow: none; 
    transform: translateY(4px); 
}

/* Secondary Button (Back - Right) */
.back-button { 
    background-color:#3b82f6 !important; 
    color:white;
    box-shadow: 0 4px 0 0 #2563eb; /* Inner color/shadow */
}
.back-button:hover { 
    background-color: #2563eb !important; 
    box-shadow: 0 2px 0 0 #1e40af; 
}
.back-button:active {
    box-shadow: none !important; 
    transform: translateY(4px); 
}

/* Styling for the result and loading divs */
#result { margin-top:1.5rem; font-weight:700; text-align:center; font-size:1.6rem; padding:0.75rem; border-radius: 8px; } 
#loading { margin-top:1rem; font-weight:bold; text-align:center; color:#5b21b6; font-size:1.4rem;}

/* Responsive adjustments */
@media (max-width: 1200px) {
    .side-design {
        display: none;
    }
    .full-page-container {
        padding: 0 2rem 4rem 2rem;
    }
    .form-container {
        margin: auto;
    }
}
@media (max-width: 650px) {
    .button-row {
        flex-direction: column;
        gap: 10px;
    }
    .button-row button {
        width: 100%;
    }
    .page-header h2 {
        font-size: 1.8rem;
    }
}
</style>
</head>
<body>

<nav>
    <a href="index.html">Home</a>
    <a href="prediction.html">Prediction</a>
</nav>

<main>
    <header class="page-header">
        <h2>Loan Application Predictor</h2>
        <p>Enter your financial and personal details below to receive an instant loan approval decision.</p>
    </header>

    <div class="full-page-container">
        <aside class="side-design">
            <h3>Key Factors</h3>
            <p>The prediction reliability is highest when these factors are favorable:</p>
            <ul>
                <li>High Income-to-Loan Ratio</li>
                <li>Excellent Credit History (1)</li>
                <li>Low Dependency Count</li>
                <li>Property in Semiurban Area</li>
            </ul>
        </aside>

        <div class="form-container">
            
            <label for="gender">Gender</label>
            <select id="gender" required>
                <option value="">Select Gender</option>
                <option value="Male">Male</option>
                <option value="Female">Female</option>
            </select>

            <label for="married">Marital Status</label>
            <select id="married" required>
                <option value="">Select Status</option>
                <option value="Yes">Yes</option>
                <option value="No">No</option>
            </select>

            <label for="dependents">Dependents</label>
            <select id="dependents" required>
                <option value="">Select Dependents</option>
                <option value="0">0</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3+">3+</option>
            </select>

            <label for="education">Education</label>
            <select id="education" required>
                <option value="">Select Education</option>
                <option value="Graduate">Graduate</option>
                <option value="Not Graduate">Not Graduate</option>
            </select>

            <label for="work">Work Profile</label>
            <select id="work" required>
                <option value="">Select Work Profile</option>
                <option value="Salaried">Salaried</option>
                <option value="Self Employed">Self Employed</option>
            </select>

            <label for="credit_history">Credit History (1=Good, 0=Bad)</label>
            <select id="credit_history" required>
                <option value="">Select Credit History</option>
                <option value="1">Good</option>
                <option value="0">Bad</option>
            </select>

            <label for="property">Property Area</label>
            <select id="property" required>
                <option value="">Select Property Area</option>
                <option value="Urban">Urban</option>
                <option value="Semiurban">Semiurban</option>
                <option value="Rural">Rural</option>
            </select>

            <label for="income">Applicant Income (INR)</label>
            <input type="number" id="income" placeholder="e.g., 4476100" required>

            <label for="coapplicant_income">Co-Applicant Income (INR)</label>
            <input type="number" id="coapplicant_income" placeholder="e.g., 1790400 (enter 0 if none)" required>

            <label for="loan">Loan Amount (INR)</label>
            <input type="number" id="loan" placeholder="e.g., 10742400" required>

            <label for="loan_term">Loan Term (Months)</label>
            <input type="number" id="loan_term" placeholder="e.g., 360" required>

            <div class="button-row">
                <button id="predictBtn" type="button">Submit Prediction</button>
                <button class="back-button" onclick="window.location.href='index.html'">Go Back to Home</button>
            </div>
            
            <div id="loading" style="display:none;">
                Processing... Please wait.
            </div>
            
            <div id="result"></div>
        </div>

        <aside class="side-design">
            <h3>Contact Support</h3>
            <p>If you encounter issues or have questions regarding the data fields, please refer to our guidelines.</p>
            <p style="margin-top: 1rem;">Email: mohitkanela@gmail.com</p>
            <p>Phone: +91 73026 79638</p> 
        </aside>
    </div>
</main>

<script>
document.getElementById('predictBtn').addEventListener('click', async () => {
    // 1. Get DOM elements
    const resultDiv = document.getElementById('result');
    const loadingDiv = document.getElementById('loading');
    
    // 2. Clear previous result and START loading state
    resultDiv.innerText = '';
    resultDiv.style.backgroundColor = ''; 
    resultDiv.style.color = ''; 
    loadingDiv.style.display = 'block'; 

    // Get raw input values
    const applicantIncomeRaw = document.getElementById('income').value;
    const coapplicantIncomeRaw = document.getElementById('coapplicant_income').value;
    const loanAmountRaw = document.getElementById('loan').value;

    const payload = {
        gender: document.getElementById('gender').value,
        married: document.getElementById('married').value,
        dependents: document.getElementById('dependents').value,
        education: document.getElementById('education').value,
        work: document.getElementById('work').value,
        property: document.getElementById('property').value,
        
        // Use the raw INR inputs (assuming the user entered INR)
        income: parseFloat(applicantIncomeRaw), 
        coapplicant_income: parseFloat(coapplicantIncomeRaw),
        loan: parseFloat(loanAmountRaw),
        
        loan_term: parseFloat(document.getElementById('loan_term').value),
        credit_history: document.getElementById('credit_history').value
    };

    // Input Validation
    for (let key in payload) {
        if (payload[key] === '' || payload[key] === null || (['income','coapplicant_income','loan','loan_term'].includes(key) && isNaN(payload[key]))) {
            loadingDiv.style.display = 'none'; // Hide loading if validation fails
            alert(`Please enter valid data for the ${key} field.`);
            return;
        }
    }

    try {
        // Make sure your Flask server is running at this address!
        const response = await fetch('http://127.0.0.1:5000/predict', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });

        const data = await response.json();

        // 3. STOP loading state
        loadingDiv.style.display = 'none'; 

        // 4. Display the result
        if (data.prediction) {
            // CHECK FOR NEGATIVE INDICATORS: 'N', 'Not Approved', or 'Rejected'
            const isRejected = data.prediction.includes("N") || data.prediction.includes("Not Approved") || data.prediction.includes("Rejected");
            
            if (isRejected) {
                // FORCE NEGATIVE MESSAGE LOGIC
                resultDiv.style.color = '#991b1b'; /* Dark red text */
                resultDiv.style.backgroundColor = '#fee2e2'; /* Light red background */
                resultDiv.innerText = `❌ Prediction: ${data.prediction} - The risk of rejection is high.`;

            } else {
                // POSITIVE MESSAGE LOGIC (if no negative indicator is found)
                resultDiv.style.color = '#065f46'; /* Dark green text */
                resultDiv.style.backgroundColor = '#d1fae5'; /* Light green background */
                resultDiv.innerText = `✅ Prediction: ${data.prediction} - Your loan is likely to be approved!`;
            }

        } else if (data.error) {
            resultDiv.style.color = '#991b1b';
            resultDiv.style.backgroundColor = '#fee2e2';
            resultDiv.innerText = `Error: ${data.error}`;
        }

    } catch (err) {
        console.error(err);
        // Error connecting to API
        loadingDiv.style.display = 'none';
        resultDiv.style.color = '#991b1b';
        resultDiv.style.backgroundColor = '#fee2e2';
        resultDiv.innerText = '⚠️ Error connecting to API. Make sure Flask server is running.';
    }
});
</script>

</body>
</html>